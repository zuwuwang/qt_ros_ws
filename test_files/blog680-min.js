(function(wnd,undefined){SinaBlog680={ver:"0.0.1"};SinaBlog680.utils={};SinaBlog680.cookie={};var LS,noop=function(){},notSupport={set:noop,get:noop,remove:noop,clear:noop,each:noop,obj:noop,length:0};(function(){if("localStorage" in window){try{LS=window.localStorage;return}catch(e){}}var o=document.getElementsByTagName("head")[0],hostKey=window.location.hostname||"localStorage",d=new Date(),doc,agent;if(!o.addBehavior){try{LS=window.localStorage}catch(e){LS=null}return}try{agent=new ActiveXObject("htmlfile");agent.open();agent.write('<script>document.w=window;<\/script><iframe src="/favicon.ico"></iframe>');agent.close();doc=agent.w.frames[0].document;o=doc.createElement("head");doc.appendChild(o)}catch(e){o=document.getElementsByTagName("head")[0]}try{d.setDate(d.getDate()+36500);o.addBehavior("#default#userData");o.expires=d.toUTCString();o.load(hostKey);o.save(hostKey)}catch(e){return}var root,attrs;try{root=o.XMLDocument.documentElement;attrs=root.attributes}catch(e){return}var prefix="p__hack_",spfix="m-_-c",reg1=new RegExp("^"+prefix),reg2=new RegExp(spfix,"g"),encode=function(key){return encodeURIComponent(prefix+key).replace(/%/g,spfix)},decode=function(key){return decodeURIComponent(key.replace(reg2,"%")).replace(reg1,"")};LS={length:attrs.length,isVirtualObject:true,getItem:function(key){return(attrs.getNamedItem(encode(key))||{nodeValue:null}).nodeValue||root.getAttribute(encode(key))},setItem:function(key,value){try{root.setAttribute(encode(key),value);o.save(hostKey);this.length=attrs.length}catch(e){}},removeItem:function(key){try{root.removeAttribute(encode(key));o.save(hostKey);this.length=attrs.length}catch(e){}},clear:function(){while(attrs.length){this.removeItem(attrs[0].nodeName)}this.length=0},key:function(i){return attrs[i]?decode(attrs[i].nodeName):undefined}};if(!("localStorage" in window)){window.localStorage=LS}})();SinaBlog680.utils.localStorage=!LS?notSupport:{set:function(key,value){if(this.get(key)!==undefined){this.remove(key)}LS.setItem(key,value);this.length=LS.length},get:function(key){var v=LS.getItem(key);return v===null?undefined:v},remove:function(key){LS.removeItem(key);this.length=LS.length},clear:function(){LS.clear();this.length=0},each:function(callback){var list=this.obj(),fn=callback||function(){},key;for(key in list){if(fn.call(this,key,this.get(key))===false){break}}},obj:function(){var list={},i=0,n,key;if(LS.isVirtualObject){list=LS.key(-1)}else{n=LS.length;for(;i<n;i++){key=LS.key(i);list[key]=this.get(key)}}return list},length:LS.length};SinaBlog680.utils.htmlToDom=function(html){var div=document.createElement("div");div.innerHTML=html;return div.childNodes};SinaBlog680.utils.isEmptyObject=function(O){for(var x in O){return false}return true};SinaBlog680.utils.getRandomInt=function(min,max){return Math.floor((max-min+1)*Math.random())+min};SinaBlog680.cookie.getCookie=function(name){name=name.replace(/([\.\[\]\$])/g,"\\$1");var rep=new RegExp(name+"=([^;]*)?;","i");var co=document.cookie+";";var res=co.match(rep);if(res){return res[1]||""}else{return""}};SinaBlog680.cookie.setCookie=function(name,value,expire,path,domain,secure){var cstr=[];cstr.push(name+"="+escape(value));if(expire){var dd=new Date();var expires=dd.getTime()+expire*3600000;dd.setTime(expires);cstr.push("expires="+dd.toGMTString())}if(path){cstr.push("path="+path)}if(domain){cstr.push("domain="+domain)}if(secure){cstr.push(secure)}document.cookie=cstr.join(";")};SinaBlog680.cookie.deleteCookie=function(name){document.cookie=name+"=;expires=Fri, 31 Dec 1999 23:59:59 GMT;"};SinaBlog680.utils.tplToData=function(template,data){var fragment="";function replace(obj){var t,key,reg;for(key in obj){reg=new RegExp("{{"+key+"}}","ig");t=(t||template).replace(reg,obj[key])}return t}fragment=replace(data);return fragment};SinaBlog680.utils.loadScript=function(url,callback){var _script=document.createElement("script");_script.type="text/javascript";_script.src=url;document.getElementsByTagName("head")[0].appendChild(_script);if(_script.readyState){_script.onreadystatechange=function(){if(_script.readyState=="loaded"||_script.readyState=="complete"){_script.onreadystatechange=null;if(callback){callback()}}}}else{_script.onload=function(){if(callback){callback()}};_script.onerror=function(){if(callback){callback()}}}};if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());SinaBlog680.jsload={};SinaBlog680.Url=function(url){url=url||"";this.url=url;this.query={};this.parse()};SinaBlog680.Url.prototype={parse:function(url){if(url){this.url=url}this.parseAnchor();this.parseParam()},parseAnchor:function(){var anchor=this.url.match(/\#(.*)/);anchor=anchor?anchor[1]:null;this._anchor=anchor;if(anchor!=null){this.anchor=this.getNameValuePair(anchor);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var query=this.url.match(/\?([^\?]*)/);query=query?query[1]:null;if(query!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(query)}},getNameValuePair:function(str){var o={};str.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(w,n,v){if(n==""){return}o[n]=v||""});return o},getParam:function(sPara){return this.query[sPara]||""},clearParam:function(){this.query={}},setParam:function(name,value){if(name==null||name==""||typeof(name)!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[name]=value},setParams:function(o){this.query=o},serialize:function(o){var ar=[];for(var i in o){if(o[i]==null||o[i]==""){ar.push(i+"=")}else{ar.push(i+"="+o[i])}}return ar.join("&")},toString:function(){var queryStr=this.serialize(this.query);return this.url+(queryStr.length>0?"?"+queryStr:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(forceSharp){return this.anchor?"#"+this.serialize(this.anchor):(forceSharp?"#":"")}};function parseParam(oSource,oParams){var key;try{if(typeof oParams!="undefined"){for(key in oSource){if(oParams[key]!=null){oSource[key]=oParams[key]}}}}finally{key=null;return oSource}}function encodeDoubleByte(str){if(typeof str!="string"){return str}return encodeURIComponent(str)}function processUrl(oOpts,oCFG){var urls=oOpts.urls;var get_hash=oOpts.GET;var i,len=urls.length;var key,url_cls,varname,rnd;for(i=0;i<len;i++){rnd=window.parseInt(Math.random()*100000000);url_cls=new SinaBlog680.Url(urls[i].url);for(key in get_hash){if(oOpts.noencode==true){url_cls.setParam(key,get_hash[key])}else{url_cls.setParam(key,encodeDoubleByte(get_hash[key]))}}varname=url_cls.getParam("varname")||"requestId_"+rnd;if(oOpts.noreturn!=true){url_cls.setParam("varname",varname)}oCFG.script_var_arr.push(varname);urls[i].url=url_cls.toString();urls[i].charset=urls[i].charset||oOpts.charset}}function createScripts(oOpts,oCFG){processUrl(oOpts,oCFG);var urls=oOpts.urls;var i,len=urls.length;for(i=0;i<len;i++){var js=document.createElement("script");js.src=urls[i].url;js.charset=urls[i].charset;js.onload=js.onerror=js.onreadystatechange=function(){if(js&&js.readyState&&js.readyState!="loaded"&&js.readyState!="complete"){return}oCFG.script_loaded_num++;js.onload=js.onreadystatechange=js.onerror=null;js.src="";js.parentNode.removeChild(js);js=null};document.getElementsByTagName("head")[0].appendChild(js)}}function jsload(aUrls,oOpts){var _opts={urls:[],charset:"utf-8",noreturn:false,noencode:false,timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var _cfg={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[]};_opts.urls=typeof aUrls=="string"?[{url:aUrls}]:aUrls;parseParam(_opts,oOpts);createScripts(_opts,_cfg);(function(){if(_opts.noreturn==true&&_opts.onComplete==null){return}var i,data=[];if(_cfg.script_loaded_num==_opts.urls.length){_cfg.is_loadcomplete=true;if(_opts.onComplete!=null){for(i=0;i<_cfg.script_var_arr.length;i++){data.push(window[_cfg.script_var_arr[i]])}if(_cfg.script_var_arr.length<2){_opts.onComplete(data[0])}else{_opts.onComplete(data)}}return}if(_cfg.is_timeout==true){return}setTimeout(arguments.callee,50)})();if(_opts.timeout>0){setTimeout(function(){if(_cfg.is_loadcomplete!=true){if(_opts.onException!=null){_opts.onException()}_cfg.is_timeout=true}},_opts.timeout)}}SinaBlog680.jsload.request=function(aUrls,oOpts){new jsload(aUrls,oOpts)};SinaBlog680.PPTBoxHelper={count:0,instance:{},getId:function(){return"_ppt_box-"+(this.count++)}};SinaBlog680.moveElement=function(elementID,final_x,interval){if(!document.getElementById){return false}if(!document.getElementById(elementID)){return false}var elem=document.getElementById(elementID);if(elem.movement){clearTimeout(elem.movement)}if(!elem.style.left){elem.style.left="0px"}var xpos=parseInt(elem.style.left,10);if(xpos==final_x){return true}if(xpos<final_x){var dist=Math.ceil((final_x-xpos)/5);xpos=xpos+dist}if(xpos>final_x){var dist=Math.ceil((xpos-final_x)/5);xpos=xpos-dist}elem.style.left=xpos+"px";var repeat="SinaBlog680.moveElement('"+elementID+"',"+final_x+","+interval+")";elem.movement=setTimeout(repeat,interval)};function PPTBox(){this.uid=SinaBlog680.PPTBoxHelper.getId();SinaBlog680.PPTBoxHelper.instance[this.uid]=this;this._$=function(id){return document.getElementById(id)};this.width=400;this.height=300;this.picWidth=15;this.picHeight=12;this.autoplayer=0;this.target="_blank";this._box=[];this._curIndex=0;this.materialtype=1;this.slot=null;this.slottype=1;this.sourceid=null;this.sudakey=null;this.sudavalue=null}PPTBox.prototype={_createMainBox:function(){var flashBoxWidth=this.width*this._box.length;var html="<div id='"+this.sourceid+"_mainbox' class='mainbox'  style='overflow:hidden;position:relative;width:"+(this.width)+"px;height:"+(this.height)+"px;'>";html+="<div id='"+this.sourceid+"_contentbox' class='flashbox' style='overflow:hidden;position:relative;width:"+flashBoxWidth+"px;height:"+(this.height)+"px;'></div>";html+="</div>";var el=SinaBlog680.utils.htmlToDom(html);this.slot.appendChild(el[0])},_init:function(){var picstyle="";var eventstr="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']";var imageHTML="";var flashbox="";var flashboxel;var sudakey=this.sudakey;var sudavalue=this.sudavalue;for(var i=0;i<this._box.length;i++){var parame=this._box[i];flashbox+=this.renderHTML(parame,this.width,this.height,i);if(flashbox!==""){if(this.slot.style.display=="none"){this.slot.style.display=""}flashboxel=SinaBlog680.utils.htmlToDom(flashbox);if(this.slot){var slotdom=this.slot;if(this.sourceid=="SLOT_41"||this.sourceid=="SLOT_42"){if(slotdom.parentNode.style.display=="none"){slotdom.parentNode.style.display=""}slotdom.parentNode.innerHTML=flashbox}else{slotdom.innerHTML=flashbox}window.setTimeout(function(){if(typeof SUDA!="undefined"&&sudakey&&sudavalue){SUDA.uaTrack(sudakey,sudavalue)}},3000)}}}},_play:function(){clearInterval(this._autoplay);var idx=this._curIndex+1;if(idx>=this._box.length){idx=0}this.changeIndex(idx);var eventstr="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(eventstr,this.autoplayer*1000)},renderHTML:function(parame,width,height,idx){var html="";var slotdom=this.slot;var tpl_xg1='<p class="atcTitCell_tit SG_dot"><a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></p><p class="atcTitCell_nm"><a {{a_c_suda}} href="{{a_href}}" class="SG_linkb" target="_blank">{{author}}</a></p>';var tpl_xg2='<span class="blogname"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></span><span class="bloguser"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="{{a_href}}" target="_blank">{{author}}</a></span>';var tpl_xg3='<p class="Ltit"><a {{a_c_suda}} href="{{a_href}}" class="BNE_lkA" target="_blank" title="{{a_title}}"><i class="icon i7_dot"></i>{{words}}</a></p><p class="Lname"><a {{a_c_suda}} href="{{a_href}}" class="BNE_lkB" target="_blank">{{author}}</a></p>';var tpl_searchqing='<a target="_blank" {{a_c_suda}} href="{{a_href}}"><img title="{{a_title}}" src="{{imgurl}}" alt="{{a_title}}"></a><span><a target="_blank" {{a_c_suda}} href="{{a_href}}">{{a_title}}</a></span>';var tpl_meishilink='<span class="SG_dot"></span><a target="_blank" {{a_c_suda}} title="{{a_title}}" href="{{a_href}}">{{a_title}}</a>';if(this.materialtype===1){var eventstr="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']";var style="";if(parame.a_href){style="cursor:pointer"}if(this.sourceid=="SLOT_98"){var sendlog="v7sendLog('30_01_02')";html="<a "+parame.a_c_suda+' onmousedown="'+sendlog+'" target="_blank" href="'+parame.a_href+'"><img titlelink="'+parame.a_href+'" destxt="'+(parame.words||"")+'" title="'+parame.a_title+'" src="'+parame.imgurl+'" /></a>'}else{html="<a "+parame.a_c_suda+' target="_blank" href="'+parame.a_href+'"><img titlelink="'+parame.a_href+'" destxt="'+(parame.words||"")+'" title="'+parame.a_title+'" src="'+parame.imgurl+'" /></a>'}}else{if(this.materialtype===2){var style="";if(parame.a_style){style=parame.a_style}if(slotdom.getAttribute("id")==="loginBarActivity"){if(/sina.allyes.com/g.test(parame.a_href)){var href=parame.a_href.match(/url=(.+)/)[1]}else{var href=parame.a_href}var sendlog="v7sendLog('41_01_11')";html='<a onmousedown="'+sendlog+'" style="'+style+'" title="'+parame.a_title+'" href="'+href+'" '+parame.a_c_suda+' target="_blank">'+parame.words+"</a>"}else{html='<a style="'+style+'" title="'+parame.a_title+'" href="'+parame.a_href+'" '+parame.a_c_suda+' target="_blank">'+parame.words+"</a>"}}else{if(this.materialtype===3){if(location.href.indexOf("tj=2")!=-1){html=SinaBlog680.utils.tplToData(tpl_xg2,parame)}else{if(scope.$pageid=="articleM_new"||scope.$pageid=="article_new"){html=SinaBlog680.utils.tplToData(tpl_xg3,parame)}else{html=SinaBlog680.utils.tplToData(tpl_xg1,parame)}}}else{if(this.materialtype===4){html=SinaBlog680.utils.tplToData(tpl_searchqing,parame)}else{if(this.materialtype===5){html=SinaBlog680.utils.tplToData(tpl_meishilink,parame)}}}}}return html},changeIndex:function(idx){var parame=this._box[idx];SinaBlog680.moveElement(this.sourceid+"_contentbox",-(idx*this.width),1);this._curIndex=idx},mouseoverPic:function(idx){this.changeIndex(idx);if(this.autoplayer>0){clearInterval(this._autoplay);var eventstr="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(eventstr,this.autoplayer*1000)}},clickPic:function(idx){var parame=this._box[idx];if(parame.a_href&&parame.a_href!==""){window.open(parame.a_href,this.target)}},add:function(imgParam){this._box[this._box.length]=imgParam},show:function(){var that=this;if(!this.slot){return}this._init()}};var resdata={};SinaBlog680.sourceArrCache=[];SinaBlog680.sourceurl="http://comet.blog.sina.com.cn/api?maintype=pageslot";var requesting=0;SinaBlog680.staticBox=function(slotArr,sourceArr){var sourceLen=sourceArr.length;var reqSourceArr=[];var cookieUtil=SinaBlog680.cookie;var reqdata={id:reqSourceArr};var articleclass="";if(typeof scope!="undefined"){articleclass=scope.$private.articleclass}for(var i=0;i<sourceLen;i++){var subSourceArr=sourceArr[i].split(",");var subSourceLen=subSourceArr.length;if(subSourceLen>1){var index=SinaBlog680.utils.getRandomInt(0,subSourceLen-1);reqSourceArr.push(subSourceArr[index])}else{if(subSourceLen==1){reqSourceArr.push(subSourceArr[0])}}}if(sourceArr.join().indexOf("SLOT_41")!=-1||sourceArr.join().indexOf("SLOT_42")!=-1){reqdata={id:reqSourceArr,articleclass:articleclass}}else{reqdata={id:reqSourceArr}}if(typeof scope!="undefined"){reqdata.blogeruid=scope.$uid}var SUPCookie=decodeURIComponent(cookieUtil.getCookie("SUP"));if(SUPCookie){var matchCookie=SUPCookie.match(/uid=([\x20-\x7e]+?)&user/);var loginuid=matchCookie.length&&matchCookie[1];reqdata.loginuid=loginuid}var domInterval=window.setInterval(function(){if(document.readyState==="complete"||document.readyState==="interactive"||document.readyState==="loaded"){if(typeof SUDA!="undefined"){clearInterval(domInterval);domInterval=null;var lsTool=SinaBlog680.utils.localStorage;var slotTime=lsTool.get("slotTime");var timestamp=new Date().getTime();var localData={};if(slotTime){var secondNum=parseInt((timestamp-slotTime)/1000,10);if(secondNum>=600){localData={};lsTool.remove("slotData");lsTool.set("slotTime",timestamp)}else{localData=lsTool.get("slotData")?JSON.parse(lsTool.get("slotData")):{}}}else{localData={};lsTool.remove("slotData");lsTool.set("slotTime",timestamp)}var titleMatch=document.location.href.match(/(\?|&)title_key=(.+?)(?=&|$)/);if(titleMatch&&titleMatch[2]){reqdata.title_key=decodeURIComponent(decodeURIComponent(titleMatch[2]));SinaBlog680.jsload.request(SinaBlog680.sourceurl,{GET:reqdata,onComplete:function(res){if(res){SinaBlog680.renderBox(slotArr,reqSourceArr,res)}},onException:function(res){}})}else{if(!localData[reqSourceArr]){SinaBlog680.jsload.request(SinaBlog680.sourceurl,{GET:reqdata,onComplete:function(res){if(res){SinaBlog680.renderBox(slotArr,reqSourceArr,res);localData[reqSourceArr]=res;lsTool.set("slotData",JSON.stringify(localData))}},onException:function(res){}})}else{SinaBlog680.renderBox(slotArr,reqSourceArr,localData[reqSourceArr])}}}}else{console.log(document.readyState)}},500);window.setTimeout(function(){if(domInterval){clearInterval(domInterval);domInterval=null}},1000*10)};SinaBlog680.renderBox=function(slotArr,sourceArr,adData){var len=slotArr.length;var cookieUtil=SinaBlog680.cookie;for(var i=0;i<len;i++){var sourceid=sourceArr[i];if(adData[sourceid]&&adData[sourceid].slottype==1){var slotdom=document.getElementById(slotArr[i]);if(typeof BLOG_AD_TIPS!="undefined"&&BLOG_AD_TIPS!=null&&slotArr[i]==="loginBarActivity"){continue}if(slotdom){var resarr=adData[sourceid].res;if(resarr.length){var box=new PPTBox();box.width=adData[sourceid].width;box.height=adData[sourceid].height;box.sourceid=sourceid;box.materialtype=adData[sourceid].materialtype;box.autoplayer=0;box.slot=slotdom;if(resarr.length===1){box.add(resarr[0]);box.sudakey=resarr[0].a_v_suda_key;box.sudavalue=resarr[0].a_v_suda_value;box.show()}else{if(resarr.length>1){var randomIndex=SinaBlog680.utils.getRandomInt(0,resarr.length-1);box.add(resarr[randomIndex]);box.sudakey=resarr[randomIndex].a_v_suda_key;box.sudavalue=resarr[randomIndex].a_v_suda_value;box.show()}}if(slotdom.style.display=="none"){slotdom.style.display=""}}}}}};SinaBlog680.preloadSlots=function(sourceArr){for(var i=0;i<sourceArr.length;i++){SinaBlog680.sourceArrCache.push(sourceArr[i])}};SinaBlog680.reqAD=function(){requesting=1;SinaBlog680.jsload.request(SinaBlog680.sourceurl,{GET:{id:SinaBlog680.sourceArrCache},onComplete:function(res){for(var key in res){resdata[key]=res[key]}requesting=0},onException:function(res){}})};SinaBlog680.fillSlot=function(sourceid,slotid){var placeEle='<a id="placeEle_'+sourceid+'"></a>';if(!slotid){document.write(placeEle)}var checkdata=window.setInterval(function(){if(document.readyState==="complete"){if(!SinaBlog680.utils.isEmptyObject(resdata)){clearInterval(checkdata);var adData=resdata;if(!adData||!adData[sourceid]){return}var box=new PPTBox();box.width=adData[sourceid].width;box.height=adData[sourceid].height;box.sourceid=sourceid;box.materialtype=adData[sourceid].materialtype;box.autoplayer=0;if(slotid){box.slot=document.getElementById(slotid)}else{box.slot=document.getElementById("placeEle_"+sourceid).parentNode}for(var j=0;j<adData[sourceid].res.length;j++){box.add(adData[sourceid].res[j]);box.show();var viewKey=adData[sourceid].res[j].a_v_suda_key;var viewValue=adData[sourceid].res[j].a_v_suda_value;SinaBlog680.sudaView(sourceid,viewKey,viewValue)}}else{if(requesting===0){SinaBlog680.reqAD()}}}},500);window.setTimeout(function(){if(checkdata){clearInterval(checkdata)}},1000*10)};SinaBlog680.fillTopBar=function(sourceid){var topBarInterval=window.setInterval(function(){var topbar_login=document.getElementById("loginBarActivity");var topbar_nologin=document.getElementById("divPopularize");if(document.readyState==="complete"){if(topbar_login){if(typeof BLOG_AD_TIPS==="undefined"||!BLOG_AD_TIPS){SinaBlog680.fillSlot(sourceid,"loginBarActivity")}clearInterval(topBarInterval)}if(topbar_nologin){if(typeof BLOG_AD_TIPS==="undefined"||!BLOG_AD_TIPS){SinaBlog680.fillSlot(sourceid,"divPopularize")}clearInterval(topBarInterval)}}},3000);window.setTimeout(function(){if(topBarInterval){clearInterval(topBarInterval)}},3000*10)};SinaBlog680.sudaView=function(sourceid,key,value){window.setTimeout(function(){var el=document.getElementById(sourceid+"_mainbox");if(typeof SUDA!=="undefined"&&el){SUDA.uaTrack(key,value)}},3000)}})(window);